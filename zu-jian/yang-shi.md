---
description: 介绍组件的样式表操作方法和相关该概念。
---

# 样式

每个组件都有自定义样式、已匹配样式、最终样式和已计算样式共四张样式表，其中已计算样式由最终样式计算而来，而最终样式则是已匹配样式与自定义样式合并而来的。

当组件的自定义样式、状态、结构以及样式库有改动的时候会触发样式计算，计算过程是先从样式库中查询与组件匹配的样式表，然后合并为一张样式表作为组件的已匹配样式，之后将已匹配样式与自定义样式合并成一张样式表作为最终样式，最后将最终样式转换为已计算样式，以供布局引擎和渲染引擎使用。

### 自定义样式

自定义样式的优先级高于样式库中样式，示例用法：

```c
Widget_SetStyle(w, key_width, 100, px);
Widget_SetStyleString(w, "width", "100px");

if (Widget_CheckStyleValid(w, key_width)) {
    Widget_UnsetStyle(w, key_width);
}
```

有些常用的样式操作可以改用更精简更具语义的函数代替，示例：

```c
Widget_Move(w, 10, 10);
Widget_Resize(w, 100, 200);
Widget_SetPadding(w, 10, 20, 10, 20);
Widget_SetMargin(w, 5, 5, 5, 5);
Widget_SetBorder(w, 1, SV_SOLID, RGB(200, 200, 200));
Widget_SetBoxShadow(w, 0, 0, 4, ARGB(30, 0, 0, 0));
Widget_Show(w);
Widget_Hide(w);
```

### 已匹配样式



### 最终样式

### 已计算样式

### 待办事项

**重新设计样式表的存储方式**

由于每个组件都要存储三张样式表，内存占用很大，尤其时组件数量达到上万数量级的时候，我们需要为样式表设计一个内存占用更低的存储方式。

**移除组件结构体中的已计算样式**

组件结构体中的 `computed_style` 成员通常只在更新和渲染组件时使用，可以尝试移除它，让它只在更新和渲染组件前临时创建。

**纠正已匹配样式在组件结构体中的命名**

已匹配样式在组件结构体中的名称是 `inherited_style`，但它记录的并不是从父级组件继承的样式，具有误导性，应该纠正为 `matched_style` 。

